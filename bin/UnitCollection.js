// Generated by CoffeeScript 1.6.3
/*
A way of storing collections of units. Prevents simple things like duplicate
units being added to the same collection.
@todo, perhaps investigate a generic collection which applies methods in bulk
to sub items instead of manually writing collections to pass through commands.
Specific commands could be overriden by parent elements.
*/


(function() {
  window.UnitCollection = (function() {
    UnitCollection.SEND_TO_SPREAD_AMOUNT = 20;

    function UnitCollection() {
      this.units = {};
    }

    UnitCollection.prototype.add = function(unit) {
      return this.units[this.getObjectKey(unit)] = unit;
    };

    UnitCollection.prototype.remove = function(unit) {
      return delete this.units[this.getObjectKey(unit)];
    };

    UnitCollection.prototype.getAll = function() {
      var key, unit, unit_array, _ref;
      unit_array = [];
      _ref = this.units;
      for (key in _ref) {
        unit = _ref[key];
        unit_array.push(unit);
      }
      return unit_array;
    };

    UnitCollection.prototype.count = function() {
      return this.getAll().length;
    };

    UnitCollection.prototype.getObjectKey = function(unit) {
      return "id-" + (unit.getId());
    };

    UnitCollection.prototype.clearAll = function() {
      var self;
      self = this;
      return $.each(this.getAll(), function(i, unit) {
        return self.remove(unit);
      });
    };

    UnitCollection.prototype.sendTo = function(position) {
      var move_to, self, unit, _i, _len, _ref, _results;
      position = position.clone();
      self = this;
      _ref = this.getAll();
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        unit = _ref[_i];
        move_to = position.clone();
        move_to.add(new Position(Random.integer(-UnitCollection.SEND_TO_SPREAD_AMOUNT, UnitCollection.SEND_TO_SPREAD_AMOUNT), Random.integer(-UnitCollection.SEND_TO_SPREAD_AMOUNT, UnitCollection.SEND_TO_SPREAD_AMOUNT)));
        _results.push(unit.setDestination(move_to));
      }
      return _results;
    };

    UnitCollection.prototype.tickAll = function() {
      var unit, _i, _len, _ref, _results;
      _ref = this.getAll();
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        unit = _ref[_i];
        _results.push(unit.tick());
      }
      return _results;
    };

    UnitCollection.prototype.setActive = function(status) {
      var unit, _i, _len, _ref, _results;
      _ref = this.getAll();
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        unit = _ref[_i];
        _results.push(unit.setActive(status));
      }
      return _results;
    };

    return UnitCollection;

  })();

}).call(this);
